<!DOCTYPE html>
<html lang="en">
<head>
  <title>ùíã ùíî ùíÑ ùíï ùíè</title>
  <meta name="description" content="jsctn">
  <meta charset="utf-8">
  <meta name="viewport" content="width=200, initial-scale=1, minimum-scale=1">
  <link rel="icon" type="image/png" href="favicon-green.png">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@700&display=swap" rel="stylesheet">
  <style type="text/css">
  :root {
    --purple: #9860ff;
    --green: #60ff60;
    --blue: #0000e0;
    --bg-color: #ebeae1;

    --line-weight: 2px;
    --font-size: 1.3em;
    --space-width: calc(1.0 * var(--font-size));
    --line-height: calc(1.1 * var(--font-size));
    --link-padding: 2px 3px;
    --link-margin: 4px;
    --row-padding: 3px;

    --toggle-left: 34%;
    --indent-top: 18px;
  }
  .done {
    --row-padding: 0;
  }
  body {
    font-family: serif;
    font-style: italic;
    background-color: #e1dfca;
    background-color: var(--bg-color);
  }
  .container {
    padding: 8px 16px 32px 16px;
  }
  h1 {
    color: var(--purple);
    margin-bottom: 60px;
  }
  h1 > span.ch {
    font-family: 'Noto Serif SC', serif;
  }
  #inner {
    font-size: var(--font-size);
    line-height: var(--font-size);
    max-width: 640px;
  }
  #inner a, #inner a:visited {
    color: var(--blue);
    background-color: var(--green);
    padding: var(--link-padding);
    border: 1px red solid;
    line-height: var(--line-height);
  }
  #inner div {
    padding: var(--row-padding);
  }
  .done div, .done a {
    border: none !important;
  }

  /* a mess of nested divs hgdfsdhggf */

  .toggle {
    border: 1px red solid;
    color: var(--purple);
    font-size: 1em;
    font-style: normal;
    text-align: left;
    width: var(--space-width);
    padding-right: 2px;
    position: relative;
  }
  .click {
    cursor: pointer;
  }
  .click.close {
    display: inline-block;
    transform: rotate(-90deg);
  }
  .link-row {
    border: 1px cyan solid;
    display: flex;
    flex-direction: row;
    align-items: stretch;
  }
  .link-row-inner {
    border: 1px white solid;
    align-items: stretch;
    display: flex;
    flex-direction: row;
    flex: 1;
    padding: var(--link-margin) 0 !important;
  }
  .link-block {
    border: 1px black solid;
    vertical-align: center;
  }
  .link-text {
    border: 1px pink solid;
    flex: 1;
  }
  .child-block {
    border: 1px magenta solid;
    display: flex;
    flex-direction: row;
  }
  .child-inner {
    border: 1px yellow solid;
  }

  /* indentation stuff */

  .indent {
    border: 1px orange solid;
    width: var(--space-width);
    position: relative;
    flex-shrink: 0;
  }
  .child-indent.mid:before, .child-indent.last:before {
    content: '';
    position: absolute;
    right: 0;
    top: var(--indent-top);
    height: var(--line-weight);
    width: calc(100% - var(--toggle-left));
    background-color: var(--purple);
  }
  .text-indent:before {
    content: '';
    position: absolute;
    left: 0;
    top: calc(var(--indent-top) - var(--link-margin));
    height: var(--line-weight);
    width: calc(100% - 8px);
    background-color: var(--purple);
  }
  .child-indent.mid:after, .block-indent.mid:after {
    content: '';
    position: absolute;
    left: var(--toggle-left);
    top: 0;
    width: var(--line-weight);
    height: 100%;
    background-color: var(--purple);
  }
  .child-indent.last:after {
    content: '';
    position: absolute;
    left: var(--toggle-left);
    top: 0;
    width: var(--line-weight);
    height: var(--indent-top);
    background-color: var(--purple);
  }
  .toggle.down:after {
    content: '';
    position: absolute;
    left: var(--toggle-left);
    bottom: -4px;
    width: var(--line-weight);
    height: calc(100% - 32px + 8px);
    background-color: var(--purple);    
  }

  </style>
</head>
<body>
  <div class="container done">
    <h1>jessica tin <span lang="zh-cn" class="ch">Áî∞ÂòâÊ¨£</span></h1>
    <div id="inner"></div>
  </div>
  <script type="text/javascript">
    const CONTENT = [
      {id: 'jsctn', name: 'jsctn.github.io', href: '/', desc: '<span style="color: #ae82ff">‚Üê you are here</span>', children: [
        {id: 'shortly', name: 'shortly, briefly', href: 'shortly-briefly', desc: '‚Äì an interactive webzine of my trip to hong kong a while ago, exploring the concept of "home." best viewed in landscape-mode', children: [
          {desc: 'best viewed in landscape mode :)'},
          {id: 'shortly-also', desc: 'also seen on..', children: [
            {name: 'altsalt', href: 'https://www.altsalt.com/listing/shortly-briefly/43'},
            {name: 'virtualgoodsdealer', href: 'https://pages.virtualgoodsdealer.com/exhibits#shortly-briefly'},
          ], open: true},
        ], open: false},
        {name: 'insta archive', desc: '(coming soon) ‚Äì archive of my old posts, as a hand-made webpage'},
      ], open: true},
      {id:'nyan', name: 'nyanseong.neocities.org', href: 'https://nyanseong.neocities.org', children: [
        {desc: 'a digital sketchbook of sorts. coding experiments and rambling thoughts. youtube autoplay.'},
        {name: 'digital fireplaces', href: 'https://nyanseong.neocities.org/fireplace.html'},
        {name: 'zine library', href: 'https://nyanseong.neocities.org/zines.html'},
      ], open: false},
      {id: 'socials', desc: 'socials..', children: [
        {name: 'twitter', href: 'https://twitter.com/jsctn'},
        {name: 'instagram', href: 'https://instagram.com/jsctn'},
      ], open: false},
      {name: 'ceremony', href: 'https://linktr.ee/ceremonyonline'},
      {name: 'howcanihelp', href: 'https://howcanihelp.carrd.co'},
      {id: 'dn', name: 'de-neglect', href: 'https://www.youtube.com/channel/UCamAWioF6v6GvOZG_Dkizmw', children: [
        {desc: 'a passion project with my friends to raise awareness about neglected tropical diseases (NTDs).'},
        {name: 'what is scabies?', href: 'https://www.youtube.com/watch?v=utvvqs0i1aY', desc: '(youtube)'},
        {name: 'lecture on NTDs', href: 'https://www.youtube.com/watch?v=k5bVz2oGfVY', desc: '(youtube)'},
        {name: 'instagram', href: 'https://instagram.com/de_neglect'},
        {name: 'twitter', href: 'https://twitter.com/deneglect'},
      ], open: false},
      {id: 'res', desc: 'some resources..', children: [
        {name: 'asian american resources', href: 'https://docs.google.com/document/d/1CGLrII9ycdPPcavGkatzGpoqGsdwJm46AgDXVWla3H8/view'},
        {name: 'guide to web accessibility', href: 'https://accessguide.io/'},
        {name: 'bay area black-owned restaurants', href: 'https://docs.google.com/spreadsheets/d/1mTthE5lwqVnTCIm3iQtQXLyxwK-pc17cuCp--BhAYX8/edit#gid=0'},
        {name: 'redistribute your wealth', href: 'https://howcanihelp.carrd.co/#donate'},
      ], open: true},
    ];
    const TOGGLE_STATE = {};
    const DOWN_ARROW = '‚ñº';
    // const RIGHT_ARROW = '‚ñ∂';
    const RIGHT_ARROW = DOWN_ARROW;
    const RIGHT_EMPTY_ARROW = '‚ñ∑';

    // initialize links from config

    function getChildHtml(children, isLast=false, depth=0, parent='') {
      if (!children || !children.length) return '';

      let childHtml = '';
      for (let i=0; i<children.length; i++) {
        const childIsLast = i === children.length - 1;
        childHtml += getNodeHtml(children[i], childIsLast, depth);
      }
      const blockIndent = depth > 1 ? `<div class="indent block-indent${isLast ? ' last' : ' mid'}">\u200b</div>` : ''; // no idea why its 1 but it works lol
      const childId = parent ? ` id="children--${parent}"` : '';
      return `<div class="child-block"${childId}>${blockIndent}<div class="child-inner">${childHtml}</div></div>`;
    }

    function getNodeHtml(node, isLast, depth) {
      const {name, href, desc, children, open, id} = node;
      if (id) TOGGLE_STATE[id] = open;

      const arrow = !children || !children.length ? RIGHT_EMPTY_ARROW : open ? DOWN_ARROW : RIGHT_ARROW;
      const arrowClass = !children || !children.length ? 'right-empty' : open ? 'down' : 'right';
      const link = name ? href ? `<a href="${href}" target="_blank">${name}</a>` : `<span style="text-decoration:underline">${name}</span>` : '';

      const canToggle = id && children && children.length;
      const toggleId = canToggle ? ` id="toggle--${id}"` : '';
      const arrowId = canToggle ? ` id="toggle-arrow--${id}"` : '';
      const handler = canToggle ? ` onclick="handleToggle('${id}')"` : '';
      const tabIndex = canToggle ? ' tabIndex="0"' : '';
      const clickOpen = open ? 'open' : 'close';
      const clickClass = canToggle ? ` class="click ${clickOpen}"` : '';
      const toggleHtml = name || children ? `<div class="toggle ${arrowClass}" ${toggleId}><span ${clickClass}${arrowId}${handler}${tabIndex}>${arrow}</span></div>` : '<div class="indent text-indent"></div>';
      // const toggleHtml = (!depth && name) || children ? `<div class="toggle ${arrowClass}${clickClass}" ${toggleId}${handler}${tabIndex}>${arrow}</div>` : '<div class="indent text-indent"></div>';

      const linkTextInner = `${link} <span class="desc">${desc ? desc : ''}</span>`.trim();
      const linkText = `<div class="link-text">${linkTextInner}</div>`;
      const blockIndent = depth > 0 ? `<div class="indent child-indent${isLast ? ' last' : ' mid'}">\u200b</div>` : '';
      const linkRow = `<div class="link-row">${blockIndent}<div class="link-row-inner">${toggleHtml}${linkText}</div></div>`;

      const childBlock = getChildHtml(children, isLast, depth + 1, id);
      return `<div class="link-block">${linkRow}${childBlock}</div>`;
    }
    
    document.getElementById('inner').innerHTML = getChildHtml(CONTENT);

    // initially hide un-open child blocks
    Object.entries(TOGGLE_STATE).forEach(([id, open]) => {
      if (!open) getChildBlockById(id).style.display = 'none';
    });

    // toggle click handler
    function handleToggle(id) {
      if (!(id in TOGGLE_STATE)) return;
      const currOpen = TOGGLE_STATE[id];

      // swap toggle arrow
      getArrowById(id).className = currOpen ? 'click close' : 'click open';

      // hide the extra line segment
      if (currOpen) getToggleById(id).className = 'toggle click';
      else getToggleById(id).className = 'toggle down click';

      // show/hide block
      const display = currOpen ? 'none' : 'flex' ;
      getChildBlockById(id).style.display = display;

      // update state
      TOGGLE_STATE[id] = !currOpen;
    }

    // dom helpers
    function getChildBlockById(id) {
      return document.getElementById(`children--${id}`);
    }
    function getToggleById(id) {
      return document.getElementById(`toggle--${id}`);
    }
    function getArrowById(id) {
      return document.getElementById(`toggle-arrow--${id}`);
    }

    // keyboard events: enter (13) or space (32)
    document.onkeydown = (e) => {
      if (!document.activeElement || !document.activeElement.id) return;
      if (e.keyCode === 13 || e.keyCode === 32) {
        const idPrefix = 'toggle-arrow--';
        if (document.activeElement.id.substring(0, idPrefix.length) !== idPrefix) return;
        e.preventDefault();
        const activeId = document.activeElement.id.substring(idPrefix.length);
        handleToggle(activeId);
      }
    };

  </script>
</body>
</html>